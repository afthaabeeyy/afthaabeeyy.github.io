<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Mystery for Shifana ‚Äî by Afthab</title>
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Montserrat:wght@300;500;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --rose:#ffb3d1;
      --lav:#b59cff;
      --accent:#ff87b8;
      --bg1:#2b0a1f;
      --bg2:#3a0f3f;
      --text:#fffdfc;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%;font-family:Montserrat,system-ui,-apple-system,Segoe UI;color:var(--text);}

    body{
      background:linear-gradient(135deg,var(--rose)10%,transparent 30%), radial-gradient(1200px 600px at 10% 10%, rgba(255,255,255,0.03), transparent 20%), linear-gradient(180deg,var(--bg1),var(--bg2));
      display:flex;align-items:center;justify-content:center;padding:24px;overflow:hidden;
      -webkit-font-smoothing:antialiased;
    }

    /* stars + subtle moving lights */
    .back{position:fixed;inset:0;z-index:0;pointer-events:none;}
    .spark{position:absolute;width:6px;height:6px;border-radius:50%;background:rgba(255,255,255,0.9);filter:blur(1px);opacity:0.9;mix-blend-mode:screen;}

    header{position:fixed;top:20px;left:20px;font-family:Great Vibes,cursive;font-size:30px;color:var(--accent);z-index:6;text-shadow:0 6px 20px rgba(0,0,0,0.5)}

    .card{
      position:relative;z-index:4;max-width:880px;width:100%;border-radius:20px;padding:28px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));backdrop-filter: blur(8px);box-shadow:0 14px 50px rgba(8,6,12,0.6);
      display:flex;flex-direction:column;align-items:center;gap:18px;min-height:520px;overflow:hidden;border:1px solid rgba(255,255,255,0.04);
    }

    .hero{margin-top:4px;text-align:center}
    .hero h1{font-family:Great Vibes,cursive;font-size:48px;color:var(--rose);text-shadow:0 0 30px rgba(255,171,200,0.12);letter-spacing:1px}
    .hero p{color:rgba(255,255,255,0.8);margin-top:4px;font-weight:300}

    .note{
      width:86%;background:rgba(255,255,255,0.02);border-radius:14px;padding:18px;min-height:150px;display:flex;align-items:flex-start;justify-content:flex-start;cursor:pointer;transition:transform .28s ease,box-shadow .28s ease;
    }
    .note:active{transform:translateY(2px);}    

    .type{font-size:18px;line-height:1.6;color:rgba(255,250,250,0.95);white-space:pre-wrap;text-align:left;width:100%}
    .cursor{display:inline-block;width:10px;height:22px;background:var(--accent);border-radius:3px;margin-left:6px;animation:blink 1s steps(2) infinite}
    @keyframes blink{50%{opacity:0}}

    .secret{width:75%;max-width:640px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:16px;padding:20px;border:1px solid rgba(255,255,255,0.05);box-shadow:0 12px 40px rgba(0,0,0,0.5);opacity:0;transform:translateY(18px) scale(.98);transition:all .5s cubic-bezier(.2,.9,.2,1);text-align:center}
    .secret.show{opacity:1;transform:translateY(0) scale(1)}
    .secret h2{font-family:Great Vibes,cursive;font-size:34px;color:var(--lav);margin-bottom:6px}
    .secret p{font-size:18px;color:rgba(255,250,250,0.95);line-height:1.5}
    .signature{margin-top:12px;font-family:Great Vibes,cursive;font-size:20px;color:rgba(255,255,255,0.9)}

    .controls{display:flex;gap:12px;margin-top:18px}
    .btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 14px;border-radius:10px;color:rgba(255,255,255,0.9);cursor:pointer;transition:all .25s}
    .btn:hover{background:rgba(255,255,255,0.06);box-shadow:0 6px 30px rgba(255,136,184,0.08)}

    /* floating hearts */
    .heart{position:absolute;font-size:22px;opacity:0.95;transform:translateY(0);animation:floatUp 4s ease-in forwards;z-index:5}
    @keyframes floatUp{0%{transform:translateY(0) scale(1);opacity:1}100%{transform:translateY(-360px) scale(.6);opacity:0}}

    /* small overlay reveal (tap to reveal) */
    .overlay{position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,0.35),rgba(0,0,0,0.5));display:flex;align-items:center;justify-content:center;z-index:5;flex-direction:column;backdrop-filter: blur(2px);}
    .reveal-button{background:linear-gradient(90deg,var(--rose),var(--lav));padding:14px 20px;border-radius:999px;color:#fff;font-weight:600;border:none;box-shadow:0 10px 40px rgba(255,140,180,0.14);cursor:pointer}
    .reveal-sub{margin-top:12px;color:rgba(255,255,255,0.9)}

    @media(max-width:520px){
      .hero h1{font-size:36px}
      .card{padding:18px}
      .note{width:92%;min-height:120px}
      .secret{width:90%}
    }
  </style>
</head>
<body>

  <!-- attempt autoplay: playsinline + autoplay attribute, JS will also try play() and listen for touchstart -->
  <audio id="bgAudio" loop playsinline preload="auto">
    <source src="https://cdn.pixabay.com/download/audio/2021/09/09/audio_8d7e7f8a6d.mp3?filename=romantic-piano-11204.mp3" type="audio/mpeg">
  </audio>

  <header>Afthab ‚ù§ Shifana</header>

  <div class="back" id="back"></div>

  <main class="card" role="main" id="card">
    <div class="hero">
      <h1>For My Mysterious Star</h1>
      <p>Tap to reveal a little secret that I've written just for you.</p>
    </div>

    <div class="note" id="note" tabindex="0" aria-label="Reveal message">
      <div class="type" id="typewriter"></div>
    </div>

    <div class="secret" id="secret">
      <h2>My Secret</h2>
      <p id="message">ante kiss aan nte fav üíñ</p>
      <div class="signature">‚Äî Afthab</div>
    </div>

    <div class="controls">
      <button class="btn" id="heartBtn">‚ô° Send Heart</button>
      <button class="btn" id="replayBtn">Replay</button>
      <button class="btn" id="muteBtn">Mute</button>
    </div>

    <!-- overlay to encourage playing on mobile (will auto-dismiss if autoplay succeeds) -->
    <div class="overlay" id="overlay">
      <button class="reveal-button" id="revealBtn">Tap to reveal</button>
      <div class="reveal-sub">(If music doesn't start, tapping will start it)</div>
    </div>
  </main>

  <script>
    // generate soft sparks
    const back = document.getElementById('back');
    for(let i=0;i<30;i++){
      const el=document.createElement('div');
      el.className='spark';
      const size = 4 + Math.random()*6;
      el.style.width = size+'px'; el.style.height = size+'px';
      el.style.left = Math.random()*100+'%'; el.style.top = Math.random()*100+'%';
      el.style.opacity = 0.6 + Math.random()*0.4;
      el.style.filter = 'blur(' + (Math.random()*2) + 'px)';
      back.appendChild(el);
    }

    // hearts generator
    function burstHeart(){
      const heart = document.createElement('div');
      heart.className='heart';
      heart.style.left = (20 + Math.random()*60) + '%';
      heart.style.bottom = '-20px';
      heart.textContent = '‚ù§';
      heart.style.fontSize = (16 + Math.random()*30) + 'px';
      document.body.appendChild(heart);
      heart.addEventListener('animationend', ()=>heart.remove());
    }

    // Typewriter text
    const lines = [
      "Dear Shifana,",
      "\nSome nights I look at the sky and I think of you.",
      "\nYou are the quiet light that changed my dark.",
      "\nKeep this little secret close.",
      "\n‚Äî Afthab"
    ];
    const typeEl = document.getElementById('typewriter');
    const secret = document.getElementById('secret');
    let typing = false;

    function typeAll(){
      typeEl.innerHTML='';
      let i=0,j=0;
      typing=true;
      function step(){
        if(i>=lines.length){typing=false;return;}
        const line = lines[i];
        if(j<line.length){
          typeEl.innerHTML = lines.slice(0,i).join('\n') + '\n' + line.slice(0,j+1) + '<span class="cursor"></span>';
          j++;setTimeout(step,30 + Math.random()*40);
        } else { i++; j=0; setTimeout(step,250); }
      }
      step();
    }

    // audio handling
    const audio = document.getElementById('bgAudio');
    const overlay = document.getElementById('overlay');

    // try autoplay on load
    function tryPlay(){
      audio.volume = 0.45;
      const p = audio.play();
      if(p !== undefined){
        p.then(()=>{
          // autoplay succeeded
          overlay.style.display = 'none';
          document.getElementById('muteBtn').textContent = 'Mute';
        }).catch(()=>{
          // autoplay blocked, leave overlay visible; will start on first tap
          overlay.style.display = '';
        });
      }
    }
    tryPlay();

    // overlay reveal button
    document.getElementById('revealBtn').addEventListener('click', ()=>{
      // start audio if not playing
      if(audio.paused){ audio.play().catch(()=>{}); }
      overlay.style.display = 'none';
      showSecret();
    });

    // clicking the note also reveals
    document.getElementById('note').addEventListener('click', ()=>{ if(audio.paused) audio.play().catch(()=>{}); showSecret(); });

    function showSecret(){
      if(!typing) typeAll();
      secret.classList.add('show');
      // burst a few hearts
      for(let i=0;i<6;i++){ setTimeout(burstHeart, i*180); }
    }

    // controls
    document.getElementById('heartBtn').addEventListener('click', ()=>{ burstHeart(); secret.querySelector('p').textContent = 'ante kiss aan nte fav üíñ'; secret.classList.add('show'); });
    document.getElementById('replayBtn').addEventListener('click', ()=>{ typeEl.innerHTML=''; secret.classList.remove('show'); setTimeout(typeAll,200); });
    document.getElementById('muteBtn').addEventListener('click', ()=>{ if(audio.paused){ audio.play(); document.getElementById('muteBtn').textContent='Mute'; } else { audio.pause(); document.getElementById('muteBtn').textContent='Play'; } });

    // accessibility: allow Enter/Space to reveal
    document.getElementById('note').addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); if(audio.paused) audio.play().catch(()=>{}); showSecret(); } });

    // attempt to detect user gesture (some mobile browsers allow play after any touch)
    function onFirstTouch(){ tryPlay(); window.removeEventListener('touchstart', onFirstTouch); }
    window.addEventListener('touchstart', onFirstTouch, {passive:true});

    // small initial hint pulse
    setTimeout(()=>{ typeEl.innerHTML = '...'; },800);
  </script>
</body>
</html>
